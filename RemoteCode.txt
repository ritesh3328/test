GetMaiTransaction----------------------------

"select pd.payment_type_id,pd.order_id,(select first_name+' '+last_name from registration_details where customer_id=(select distinct customer_id from payment_details where hotel_id=@HOTEL_ID and pd.order_id=ORDER_ID)) as Name,(select card_holder_name from card_details where hotel_id=pd.hotel_id and order_id=pd.order_id) as cardholdername,isnull(total_amount,0) as total_amount,isnull((SELECT amount_paid FROM Payment_details WHERE (hotel_id = pd.hotel_id) AND (order_id = pd.order_id) AND (VendorTxCode = pd.VendorTxCode) AND (TxType = 'PAYMENT')), 0) AS Payments,isnull((SELECT amount_paid FROM Payment_details WHERE (hotel_id = pd.hotel_id) AND (order_id = pd.order_id) AND (VendorTxCode = pd.VendorTxCode) AND (TxType = 'REFUND')), 0) AS Refunds,pd.TxType,pd.vendortxcode,(SELECT order_status FROM Order_header WHERE (order_id = pd.order_id) AND (hotel_id = pd.hotel_id)) AS Status,isnull(TxStatus,0) as TxStatus,(select card_number from card_details where hotel_id=pd.hotel_id and order_id=pd.order_id) as cardnumber,isnull(pd.txto,0) as txto,pd.txat,pd.txn_date as txndate,pd.txn_status as txnstatus from payment_details pd where pd.hotel_id=@HOTEL_ID and pd.order_id=@ORDER_ID order by payment_type_id";


----------------------------------------------------------------------------------------------------------------------------------------

select pd.payment_type_id,pd.order_id,(select first_name+' '+last_name from registration_details where customer_id=(select distinct customer_id from payment_details where hotel_id=@HOTEL_ID and pd.order_id=ORDER_ID)) as Name,(select card_holder_name from card_details where hotel_id=pd.hotel_id and order_id=pd.order_id) as cardholdername,isnull(total_amount,0) as total_amount,isnull((SELECT amount_paid FROM Payment_details WHERE (hotel_id = pd.hotel_id) AND (order_id = pd.order_id) AND (VendorTxCode = pd.VendorTxCode) AND (TxType = 'PAYMENT')), 0) AS Payments,isnull((SELECT amount_paid FROM Payment_details WHERE (hotel_id = pd.hotel_id) AND (order_id = pd.order_id) AND (VendorTxCode = pd.VendorTxCode) AND (TxType = 'REFUND')), 0) AS Refunds,pd.TxType,pd.vendortxcode,(SELECT order_status FROM Order_header WHERE (order_id = pd.order_id) AND (hotel_id = pd.hotel_id)) AS Status,isnull(TxStatus,0) as TxStatus,(select card_number from card_details where hotel_id=pd.hotel_id and order_id=pd.order_id) as cardnumber,isnull(pd.txto,0) as txto,pd.txat,pd.txn_date as txndate,pd.txn_status as txnstatus from payment_details pd where pd.hotel_id=@HOTEL_ID and pd.order_id=@ORDER_ID order by payment_type_id